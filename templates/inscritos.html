
<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Ministério de Louvor - Cadastro</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/>
<style>
    .logo-peniel {
        width: 120px;
        margin-bottom: 10px;
        transition: filter 0.3s ease;
    }
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #f2f7f4;
    }
    .top-bar {
        background-color: #d4edda;
        padding: 10px 20px;
        position: sticky;
        top: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
        box-shadow: 0px 2px 5px rgba(0,0,0,0.1);
    }
    .top-bar .buttons {
        display: flex;
        gap: 10px;
    }
    .top-bar button {
        background-color: #28a745;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
    }
    .top-bar button:hover {
        background-color: #218838;
    }
    .logo-title {
        text-align: center;
        margin: 20px 0 10px 0;
    }
    .logo-title img {
        width: 80px;
    }
    .logo-title h1 {
        margin: 5px 0 0 0;
        font-size: 22px;
        color: #2d6a4f;
    }
   .search-filter {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        gap: 20px;
    }
    .search-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: auto;
    }
    #toggleSearchBtn {
        background-color: #6FCF97;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        width: auto;
        height: auto;
    }
    #searchBar {
         margin-top: 5px;
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #ccc;
        display: none;
        width: 200px;
    }

    #areaFiltros {
        display: none;
        justify-content: center;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
    }
    
    .hidden {
        display: none;
    }
    .table-container {
        overflow-x: auto;
        margin: 20px;
    }
    table {
        border-collapse: collapse;
        width: 100%;
        min-width: 1400px;
    }
    th, td {
        padding: 10px;
        text-align: center;
        border-bottom: 1px solid #ccc;
        border-right: 1px solid #ccc;
    }
    th {
        background-color: #40916c;
        color: white;
    }
    tr:nth-child(even) {
        background-color: #e9f5ee;
    }
    tr:nth-child(odd) {
        background-color: #ffffff;
    }
    tr:hover {
        background-color: #c4f1ce;
        cursor: pointer;
    }
    .inativo {
        background-color: #fceeee !important;
        color: #777;
    }
    #areaFiltros {
        display: none;
        justify-content: center;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
    }
    #areaFiltros select {
        padding: 8px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }
    
    #toggleFiltrosBtn {
        background-color: #6FCF97;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        width: auto;
        height: auto;
    }

    #toggleFiltrosBtn.icon::before {
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        content: "\f0b0";
        margin-right: 8px;
    }

    #toggleFiltrosBtn.text {
        padding: 8px 12px;
    }

    #tabelaInscritos tbody td:first-child {
        text-align: left;
    }
    #toggleSearchBtn:hover,
    #toggleFiltrosBtn:hover {
        color: #218838; /* Cor mais escura ao passar o mouse */
        cursor: pointer; /* Opcional: mudar o cursor para 'pointer' */
    }
    #toggleFiltrosBtn.active {
        padding: 8px 12px;
        color: #2d6a4f; /* Cor quando os filtros estão ativos */
    }
    #toggleSearchBtn.search-active {
        color: #2d6a4f; /* Cor quando a barra de pesquisa está ativa */
    }
        /* Modo escuro */
        .dark-mode { background-color: #2a2a2a; color: white; }
        .dark-mode .card { background: #1e1e1e; color: white; }
        .dark-mode .top-bar { background-color: #2e413a; }

                /* Modo escuro para tabela */
        .dark-mode table {
            background-color: #1e1e1e;
            color: #ffffff;
        }

        .dark-mode th {
            background-color: #3a3a3a;
            color: #ffffff;
        }

        .dark-mode td {
            border-color: #555;
        }

        .dark-mode tr:nth-child(even) {
            background-color: #2d2d2d;
        }

        .dark-mode tr:nth-child(odd) {
            background-color: #1e1e1e;
        }

        .dark-mode tr:hover {
            background-color: #444 !important;
        }
        .dark-mode .logo-peniel {
        filter: invert(1) brightness(1.2);
      }
        .dark-mode label,
        .dark-mode h3,
        .dark-mode h4,
        .dark-mode h2,
        .dark-mode h1,
        .dark-mode p {
            color: #bdbdbd !important;
        }
        .dark-mode .inativo {
            background-color: #402020 !important;
            color: #bbb;
            }

</style>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"/>
</head>
<body>
<style>
@media (max-width: 600px) {
  .top-bar button span {
    display: none;
  }
}
</style>
<div class="top-bar">
<div class="buttons">
<button onclick="location.href='/'"><i class="fas fa-plus"></i> <span>Novo</span></button>
<button onclick="location.href='/exportar_csv'"><i class="fas fa-file-excel"></i> <span>Exportar Planilha</span></button>
<button onclick="location.href='/gerenciar'"><i class="fas fa-tools"></i> <span>Gerenciar</span></button>
</div>
<div class="buttons">
<button class="icon-btn" onclick="toggleDarkMode()"><i class="fas fa-moon"></i></button>
<button class="icon-btn" onclick="location.href='/logout'"><i class="fas fa-sign-out-alt"></i></button>
</div>
</div>
<div class="buttons">
<div class="logo-title">
<img alt="Logo Peniel" class="logo-peniel" src="{{ url_for('static', filename='peniel-removebg-preview.png') }}"/>
<h1>Ministério de Louvor - CADASTRO</h1>
</div>
<div class="search-filter">
<div class="search-container">
<button id="toggleSearchBtn" onclick="toggleSearch()"><i class="fas fa-search"></i></button>
<input id="searchBar" onkeyup="filterByName()" placeholder="Buscar por nome..." type="text"/>
</div>
<button class="icon-btn" id="toggleFiltrosBtn" onclick="toggleFiltros()"><i class="fas fa-filter"></i></button>
</div>
<div id="areaFiltros">
<select id="filtroEstadoCivil" onchange="filterTable()">
<option value="">Estado Civil</option>
<option value="Solteiro(a)">Solteiro(a)</option>
<option value="Casado(a)">Casado(a)</option>
<option value="Divorciado(a)">Divorciado(a)</option>
<option value="Divorciado(a)">Viuvo(a)</option>
</select>
<select id="filtroBatizado" onchange="filterTable()">
<option value="">Batizado</option>
<option value="Sim">Sim</option>
<option value="Não">Não</option>
</select>
<select id="filtroPerfil" onchange="filterTable()">
<option value="">Perfil</option>
<option value="Cantor(a)">Cantor(a)</option>
<option value="Instrumentista">Instrumentista</option>
<option value="Ambos">Ambos</option>
</select>
<select id="filtroVoz" onchange="filterTable()">
<option value="">Classificação Vocal</option>
<option value="Soprano">Soprano</option>
<option value="Contralto">Contralto</option>
<option value="Tenor">Tenor</option>
<option value="Baixo">Baixo</option>
<option value="Barítono">Barítono</option>
<option value="Não sei">Não sei</option>
</select>
<select id="filtroInstrumento" onchange="filterTable()">
<option value="">Instrumento</option>
<option value="Violão">Violão</option>
<option value="Guitarra">Guitarra</option>
<option value="Baixo">Baixo</option>
<option value="Teclado">Teclado</option>
<option value="Bateria">Bateria</option>
<option value="Outro">Outro</option>
</select>
<select id="filtroStatus" onchange="filterTable()">
<option value="">Status</option>
<option value="Ativo">Ativo</option>
<option value="Inativo">Inativo</option>
</select>
</div>
<div style="text-align: center; margin-top: 10px;">
<button id="limparFiltrosBtn" onclick="limparFiltros()" style="background-color: #f18484; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; display: none;">Limpar Filtros</button>
</div>
<div class="table-container">
<table id="tabelaInscritos">
<thead>
<tr>
<th>Nome</th>
<th>Telefone</th>
<th>Email</th>
<th>Perfil</th>
<th>Instrumentos</th>
<th>Outro</th>
<th>Nível Técnico</th>
<th>Classificação</th>
<th>Ensaios</th>
<th>Nascimento - Idade</th>
<th>Estado Civil</th>
<th>Status</th>
</tr>
</thead>
<tbody>
        {% for inscrito in inscritos %}
         <tr class="{% if inscrito[27] == 0 %}inativo{% endif %} {% if inscrito[26] == 0 %}inativo{% endif %}" data-status="{{ inscrito[27] }}" onclick="window.location.href='/detalhes/{{ inscrito[0] }}';"> <td><strong>{{ inscrito[1] }}</strong></td>
<td>{{ inscrito[3] }}</td>
<td>{{ inscrito[4] }}</td>
<td>{{ inscrito[14] }}</td>
<td>{{ inscrito[18] }}</td>
<td>{{ inscrito[19] }}</td>
<td>{{ inscrito[22] }}</td>
<td>{{ inscrito[15] }}</td>
<td>{{ inscrito[23] }}</td>
<td>{{ inscrito[2] }}</td>
<td>{{ inscrito[12] }}</td>
<td>{% if inscrito[27] == 1 %}Ativo{% else %}Inativo{% endif %}</td>
</tr>
    {% endfor %}
    </tbody>
</table>
</div>
<script>
function ordenarTabelaPorStatus() {
    var tabela = document.getElementById('tabelaInscritos');
    var linhas = Array.from(tabela.querySelectorAll('tbody tr'));

    // Separa as linhas ativas e inativas
    var ativos = linhas.filter(linha => linha.dataset.status == '1');
    var inativos = linhas.filter(linha => linha.dataset.status == '0');

    // Remove todas as linhas da tabela
    linhas.forEach(linha => tabela.querySelector('tbody').removeChild(linha));

    // Adiciona as linhas ativas de volta
    ativos.forEach(linha => tabela.querySelector('tbody').appendChild(linha));

    // Adiciona as linhas inativas no final
    inativos.forEach(linha => tabela.querySelector('tbody').appendChild(linha));
}

// Chama a função para ordenar a tabela quando a página carregar
window.onload = ordenarTabelaPorStatus;

function toggleSearch() {
    var searchBar = document.getElementById('searchBar');
    var btn = document.getElementById('toggleSearchBtn'); // Seleciona o botão
    if (searchBar.style.display === 'none' || searchBar.style.display === '') {
        searchBar.style.display = 'block';
        btn.classList.add('search-active'); // Adiciona a classe
    } else {
        searchBar.style.display = 'none';
        btn.classList.remove('search-active'); // Remove a classe
    }
}

function toggleFiltros() {
    var filtros = document.getElementById("areaFiltros");
    var btn = document.getElementById("toggleFiltrosBtn");

    if (filtros.style.display === "none" || filtros.style.display === "") {
        filtros.style.display = "flex";
        btn.classList.add("active"); // Adiciona a classe 'active'
    } else {
        filtros.style.display = "none";
        btn.classList.remove("active"); // Remove a classe 'active'
    }
}

function filterTable() {
    var estadoCivil = document.getElementById("filtroEstadoCivil").value.toLowerCase();
    var batizado = document.getElementById("filtroBatizado").value.toLowerCase();
    var perfil = document.getElementById("filtroPerfil").value.toLowerCase();
    var voz = document.getElementById("filtroVoz").value.toLowerCase();
    var instrumento = document.getElementById("filtroInstrumento").value.toLowerCase();
    var status = document.getElementById("filtroStatus").value.toLowerCase();

    var table = document.getElementById("tabelaInscritos");
    var trs = table.getElementsByTagName("tr");
    var limparFiltrosBtn = document.getElementById("limparFiltrosBtn");
    var algumFiltroAtivo = estadoCivil || batizado || perfil || voz || instrumento || status;

    limparFiltrosBtn.style.display = algumFiltroAtivo ? "inline-block" : "none";

    for (var i = 1; i < trs.length; i++) {
        var tds = trs[i].getElementsByTagName("td");
        if (tds.length > 0) {
            var match = true;

            if (estadoCivil && !tds[10].innerText.toLowerCase().includes(estadoCivil)) match = false;
            if (batizado && !tds[5].innerText.toLowerCase().includes(batizado)) match = false;
            if (perfil && !tds[3].innerText.toLowerCase().includes(perfil)) match = false;
            if (voz && !tds[7].innerText.toLowerCase().includes(voz)) match = false;
            if (instrumento && !tds[4].innerText.toLowerCase().includes(instrumento)) match = false;
            if (status && !tds[11].innerText.toLowerCase().includes(status)) match = false;

            trs[i].style.display = match ? "" : "none";
        }
    }
}

function limparFiltros() {
    document.getElementById("filtroEstadoCivil").value = "";
    document.getElementById("filtroBatizado").value = "";
    document.getElementById("filtroPerfil").value = "";
    document.getElementById("filtroVoz").value = "";
    document.getElementById("filtroInstrumento").value = "";
    document.getElementById("filtroStatus").value = "";
    filterTable(); // Recarrega os filtros e esconde o botão se necessário
    document.getElementById("limparFiltrosBtn").style.display = "none"; // Garante que o botão some
}

function filterByName() {
    var input = document.getElementById("searchBar");
    var filter = input.value.toLowerCase();
    var table = document.getElementById("tabelaInscritos");
    var trs = table.getElementsByTagName("tr");
    for (var i = 1; i < trs.length; i++) {
        var td = trs[i].getElementsByTagName("td")[0];
        if (td) {
            trs[i].style.display = td.innerText.toLowerCase().includes(filter) ? "" : "none";
        }
    }
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}



function toggleDarkMode() {
    const isDark = document.body.classList.toggle('dark-mode');
    localStorage.setItem('modoEscuro', isDark ? 'ativado' : 'desativado');
}

// Aplica o modo escuro automaticamente se estiver ativado
window.onload = function () {
    if (localStorage.getItem('modoEscuro') === 'ativado') {
        document.body.classList.add('dark-mode');
    }
}
</script>
<script>
document.querySelectorAll("th").forEach(th => {
  th.draggable = true;

  th.addEventListener("dragstart", (e) => {
    e.dataTransfer.setData("text/plain", Array.from(th.parentNode.children).indexOf(th));
  });

  th.addEventListener("dragover", (e) => {
    e.preventDefault();
    th.style.borderLeft = "2px solid #28a745";
  });

  th.addEventListener("dragleave", () => {
    th.style.borderLeft = "";
  });

  th.addEventListener("drop", (e) => {
    e.preventDefault();
    th.style.borderLeft = "";

    const oldIndex = parseInt(e.dataTransfer.getData("text/plain"));
    const newIndex = Array.from(th.parentNode.children).indexOf(th);

    const table = th.closest("table");
    const rows = Array.from(table.rows);

    rows.forEach(row => {
      const cells = Array.from(row.cells);
      if (cells.length > Math.max(oldIndex, newIndex)) {
        const temp = cells[oldIndex].innerHTML;
        cells[oldIndex].innerHTML = cells[newIndex].innerHTML;
        cells[newIndex].innerHTML = temp;
      }
    });
  });
});
</script>
</div></body>
</html>
